---
/**
 * Day Details Page
 *
 * Strona szczegółów dnia - wyświetla podsumowanie kalorii i listę posiłków.
 * Dynamic route: /day/YYYY-MM-DD
 */

import Layout from "@/layouts/Layout.astro";
import { DayDetails } from "@/components/day-details/DayDetails";

// Get date from URL params
const { date } = Astro.params;

// Validate date format (YYYY-MM-DD)
const dateRegex = /^\d{4}-\d{2}-\d{2}$/;
if (!date || !dateRegex.test(date)) {
  return Astro.redirect("/");
}

// Parse date for title
const parsedDate = new Date(date);
const formattedDate = new Intl.DateTimeFormat("pl-PL", {
  weekday: "long",
  day: "numeric",
  month: "long",
  year: "numeric",
}).format(parsedDate);
---

<Layout title={`${formattedDate} - Szybkie Kalorie`}>
  <DayDetails
    date={date}
    onBack={() => {
      // Client-side navigation back to dashboard
      if (typeof window !== 'undefined') {
        window.location.href = '/';
      }
    }}
    client:load
  />
</Layout>
